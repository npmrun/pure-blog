---
import { single, published, getPost } from '@blog/utils';
import type { Post, PostProps } from '#/post';
import { showArticleHeroImage, githubURL } from "@blog/config"
import Base from "./_ui/Base.astro"

export interface extendProps {
	
}
export type Props = Partial<PostProps> & extendProps

let { title, description, pubDate, updatedDate, heroImage, _images, filePath, _head} = getPost(Astro.props as Props) as Props

if(showArticleHeroImage && _images && _images.length){
	heroImage = _images[0].url
}

---
<Base title={title} description={description}>
		{heroImage && <img class="hero-image" src={heroImage} alt="" />}
		<article class="typo article">
				<h1 class="title">{title}</h1>
				{pubDate && <time>{pubDate}</time>}
				{updatedDate && (
					<div>
						Last updated on <time>{updatedDate}</time>
					</div>
				)}
				{filePath && <a href={githubURL+"/article"+filePath} target="_blank" style="margin: 6px 0;display: inline-block;">在Github编辑</a>}
				<hr />
				<slot />
		</article>
		<ul slot="side">
			<div class="title">目录</div>
		{
                            !!_head &&
                            !!_head.length && (
                                <>
																{_head.map((v) => (
                                                <li><a
                                                    class="head"
                                                    style={{
                                                        marginLeft:
                                                            (v.level - 1) * 15 +
                                                            "px",
                                                        "overflow-x": "hidden",
                                                        "white-space": "nowrap",
                                                        "text-overflow": "ellipsis"
                                                    }}
                                                    href={"#" + v.title}
                                                >
                                                    # {v.title}
                                                </a></li>
                                            ))}
																</>
                            )
		}
		</ul>
</Base>

<style lang="scss">
			ul{
				.title{
					height: 35px;
					line-height: 35px;
					font-weight: bold;
				}
			}
		</style>